TOP=../..

SYNCFLAGS=-md5sum_in_auxfile -less_marks -lang ocaml

DOC=CompilerGenerator
DOC_EXTRA=
VERSION=3

# the Parser.mly are synced separately
SRC=\
  lex/Ast.ml \
  lex/Output.mli \
  lex/Output.ml \
  lex/Lexgen.mli \
  lex/Lexgen.ml \
  lex/Compact.mli \
  lex/Compact.ml \
  lex/CLI.mli \
  lex/CLI.ml \
  lex/Main.ml \
  lex/Lexer.mll \
  lib_parsing/Lexing_.mli \
  lib_parsing/Lexing_.ml \
  yacc/ast.ml \
  yacc/check.mli \
  yacc/check.ml \
  yacc/lr0.mli \
  yacc/lr0.ml \
  yacc/first_follow.mli \
  yacc/first_follow.ml \
  yacc/lrtables.ml \
  yacc/slr.mli \
  yacc/slr.ml \
  yacc/lalr.mli \
  yacc/lalr.ml \
  yacc/output.mli \
  yacc/output.ml \
  yacc/dump.mli \
  yacc/dump.ml \
  yacc/tests.ml \
  yacc/lexer.mll \
  yacc/main.ml \
  lib_parsing/parsing_.mli \
  lib_parsing/parsing_.ml \

SRC_VIEWS=${SRC:%=$TOP/%}

# must be in the same order than the #include in $DOC.nw for syncweb to work
SRC_ORIG=CompilerGenerator.nw CompilerGenerator_extra.nw


<$TOP/docs/latex/mkcommon

#TODO!!!!
SYNCFLAGS2=-md5sum_in_auxfile -less_marks -lang ocamlyacc
sync_yacc:V:
	syncweb $SYNCFLAGS2 $SRC_ORIG $TOP/lex/Parser.mly
#	syncweb $SYNCFLAGS2 $SRC_ORIG $TOP/yacc/parser.mly


#TODO: add also $PLAN9ML/yacc! but right now conflicting module names
# are a limitations in codegraph/ocaml
#TODO: restore
#index:V:
#	$INDEXER -lang cmt $PLAN9ML/lib_core/commons $PLAN9ML/lex  \
#    | sed -e 's#main.cmt#Main#' \
#    | grep -v 'lib_core/' \
#    | grep -v 'Common.=~' \
#    > defs_and_uses.list
#index:V:
#	echo TODO index
#	touch defs_and_uses.list
