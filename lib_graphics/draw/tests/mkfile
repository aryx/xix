# -*- sh -*-
TOP=../../..

INCLUDES=-I $TOP/lib_core/commons \
  -I $TOP/lib_graphics/geometry -I $TOP/lib_graphics/draw
LIBS=$TOP/lib_core/commons/lib.cma $TOP/lib_core/regexps/lib.cma \
 $TOP/lib_graphics/geometry/lib.cma $TOP/lib_graphics/draw/lib.cma
SYSLIBS=unix.cma

PTOP=$TOP/principia
objtype=386
#alt:</$TOP/mkconfig
CAMLLIB=$PTOP/ROOT/$objtype/lib/ocaml
OCAMLC=/usr/local/bin/ocamlrun /usr/local/bin/ocamlc $INCLUDES
CCLIBS= -cclib $CAMLLIB/libunix.a -cclib $CAMLLIB/main.8

#############################################################################
# Toplevel targets
#############################################################################

PROGS=hellodraw test_font
#gen_font_default

all:V: $PROGS

hellodraw: $LIBS hellodraw.ml
	$OCAMLC  -verbose $SYSLIBS -custom $prereq -o $target $CCLIBS

test_font: $LIBS test_font.ml
	$OCAMLC  -verbose $SYSLIBS -custom $prereq -o $target $CCLIBS

# need to unset CAMLLIB above to be able to compile this program
gen_font_default: gen_font_default.ml ../font_default.ml
	ocamlc -g -I $TOP/lib_core/commons -I ../ $TOP/lib_core/commons/lib.cma ../font_default.ml gen_font_default.ml  -o testfont

clean:V:
	rm -f *.cma *.cmo *.cmi *.8 $PROGS

<$TOP/mkfiles/mkcommon
